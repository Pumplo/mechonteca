{% extends 'pagina/base.html' %} 
{% block title %}Dashboard - USM{% endblock %}

{% block content %}
    <!-- Contenido de la SECCIÃ“N 2: DASHBOARD del boceto -->
    <section id="dashboard">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">Tu Ruta de NivelaciÃ³n</h1>

        <!-- MENSAJE DE BIENVENIDA DINÃMICO (Requiere JS) -->
        <div id="welcome-message" class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 rounded-lg shadow-md mb-6">
            <p class="font-semibold text-lg">Cargando mensaje de bienvenida...</p>
        </div>
        <!-- FIN MENSAJE DE BIENVENIDA DINÃMICO -->

        <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
            <h2 class="text-xl font-semibold mb-2">Progreso General:7%</h2>
            <div class="w-full md:w-full bg-gray-200 rounded-full h-4">
                <div class="progress-bar-bg h-4 rounded-full" style="width: 40%"></div>
            </div>
            <p class="text-sm text-gray-500 mt-2">Â¡Sigue asÃ­! Te quedan x cursos por completar.</p>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Curso CÃ¡lculo I -->
            <div class="course-card bg-white p-6 rounded-xl shadow-md border-l-8 border-blue-600">
                <h3 class="text-2xl font-bold mb-3 text-gray-800">CÃ¡lculo I</h3>
                <p class="text-sm text-gray-500 mb-4">AnÃ¡lisis del tema, lÃ­mites y derivadas esenciales.</p>
                
                <div id="calculo-topicos" class="space-y-2 text-sm hidden">
                    <div class="flex justify-between items-center py-1">
                        <span>âœ… TÃ³pico 1: LÃ­mites</span>
                        <span class="text-green-600 font-semibold">100%</span>
                    </div>
                    <div class="flex justify-between items-center py-1">
                        <span>ðŸŸ¡ TÃ³pico 2: Derivadas</span>
                        <span class="text-yellow-600 font-semibold">60%</span>
                    </div>
                    <div class="flex justify-between items-center py-1">
                        <span>âšª TÃ³pico 3: Integrales</span>
                        <span class="text-gray-400 font-semibold">0%</span>
                    </div>
                </div>
                <button class="toggle-topicos w-full mt-4 bg-blue-100 text-blue-700 text-sm px-4 py-2 rounded-lg" data-target="calculo-topicos">
                    Ver TÃ³picos
                </button>
                <button class="w-full mt-2 btn-usm-primary text-sm px-4 py-2 rounded-lg">
                    Continuar con Derivadas
                </button>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
    // JS para la lÃ³gica del Dashboard (mensajes de bienvenida y toggles)
    const welcomeMessages = [
        "Â¡Hola, Sansano! Tu ruta de nivelaciÃ³n te espera. Â¡A darle con todo!",
        "El conocimiento es poder. Mira tu progreso y planifica tu prÃ³xima meta.",
        "Recuerda revisar el AlmacÃ©n Colaborativo para nuevos apuntes y certÃ¡menes.",
        "Â¡Vamos por ese 100%! Tienes 3 cursos pendientes para alcanzar la meta.",
        "Tu esfuerzo de hoy es tu Ã©xito de maÃ±ana. Â¡Sigue avanzando!",
        "Si no te gusta cÃ³mo son las cosas, cÃ¡mbialas",
        "Sin estudiar se enferma el alma",
        "Todo es practica",
    ];

    function getWelcomeMessage() {
        const index = Math.floor(Math.random() * welcomeMessages.length);
        return welcomeMessages[index];
    }

    function updateWelcomeMessage() {
        const messageElement = document.getElementById('welcome-message');
        if (messageElement) {
            messageElement.querySelector('p').textContent = getWelcomeMessage();
        }
    }

    // Toggle para mostrar/ocultar tÃ³picos en las tarjetas de curso
    document.querySelectorAll('.toggle-topicos').forEach(button => {
        button.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const targetElement = document.getElementById(targetId);
            const isHidden = targetElement.classList.contains('hidden');
            
            // Cierra otros tÃ³picos y restablece botones
            document.querySelectorAll('.toggle-topicos').forEach(btn => {
                const id = btn.getAttribute('data-target');
                document.getElementById(id).classList.add('hidden');
                btn.textContent = 'Ver TÃ³picos';
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('bg-blue-100', 'text-blue-700');
            });

            // Abre el tÃ³pico clickeado
            if (isHidden) {
                targetElement.classList.remove('hidden');
                this.textContent = 'Ocultar TÃ³picos';
                this.classList.remove('bg-blue-100', 'text-blue-700');
                this.classList.add('bg-blue-600', 'text-white');
            }
        });
    });

    // InicializaciÃ³n del mensaje de bienvenida
    window.onload = updateWelcomeMessage;
</script>
{% endblock %}
